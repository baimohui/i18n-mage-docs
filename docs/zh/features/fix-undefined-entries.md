# 🛠 修复未定义词条

在开发多语言项目的过程中，常见的情况是：在代码里写了 `t('某中文文案')` 或者 `t('Some literal')`，但对应的翻译文件里并没有相应的 key 定义。这时就出现“未定义词条”的问题。i18n Mage 的“修复未定义词条”功能可以帮助你一键处理这些问题，使代码与翻译文件同步。

## 功能亮点

* **自动扫描未定义词条**：检测项目中所有 `t(...)` 或类似用法里，未在语言文件中定义的文本。
* **智能匹配已有词条**：若插件在已有词条中发现与文本内容一致或高度相似的条目，会优先建议使用已有 Key，避免重复定义。
* **自动生成 Key**：若没有匹配项，插件会根据设置的命名规则（如驼峰、下划线、路径形式等）生成新的 Key。
* **自动翻译并写入多语言文件**：对新生成的 Key，插件根据配置的翻译服务（如 DeepL、Google、百度、腾讯等）自动生成对应语言的译文并写入翻译文件。 ([Tencent Cloud][2])
* **代码替换**：将原本写在 `t('literal')` 中的文字替换成 `t('generated.key')`（或建议的 key），同步代码与翻译文件。
* **交互预览 & 审核**：在执行替换前，会弹出预览界面显示：原始文本、拟使用的 key、译文等，让用户确认或手动调整。
* **安全过滤**：自动排除变量、模板字符串、动态拼接、正则／脚本片段等不应被作为 literal 的部分，减少误操作。


## 📋 使用流程（面向用户）

以下是用户实际使用“修复未定义词条”功能的典型流程：

1. **触发修复命令**

   * 可使用快捷键（`Ctrl+Alt+F`）或命令面板（如 `i18n Mage: 修复未定义词条`）。
   * 也可能在资源管理器或编辑器右键菜单中支持“当前文件修复未定义词条”。

2. **扫描与分析**

   * 插件扫描当前项目 / 工作区（或当前文件）中的所有 `t(...)` 或国际化函数调用。
   * 判断哪些是“未定义词条”（即在所有语言文件中都不存在对应 Key）。
   * 对于每一条未定义，尝试在现有词条中查找匹配。

<!-- 3. **预览候选方案**
   对每个未定义条目，插件会给出一个候选列表，通常包括：

   | 原始文本     | 建议 Key               | 是否匹配已有                  | 各语言翻译候选                                                                        |
   | -------- | -------------------- | ----------------------- | ------------------------------------------------------------------------------ |
   | “请输入用户名” | `user.enterUsername` | 否                       | { en: "Please enter username", fr: "Veuillez entrer le nom d’utilisateur", … } |
   | “登录失败”   | `login.fail`         | 在已有条目中匹配到 `login.error` | …                                                                              |

   * 用户可以手动修改建议 Key 或翻译结果。
   * 可以勾选或取消某些条目是否要在这次修复中应用。 -->

3. **确认应用**

   * 点击 **应用 / 确认** 后，插件将执行以下操作：

     1. 将所有选中条目的翻译写入各语言文件；
     2. 替换源码中的原始文本调用为 `t('建议的 Key')`；
     3. 保持文件结构、格式、缩进等一致。

<!-- 5. **后续校验**

   * 操作完成后，可以使用插件提供的“检查”功能，确认是否还有遗漏的未定义词条。
   * 在团队协作中，可将生成的词条导出给翻译人员复查。


## ✅ 使用建议与注意事项

* **慎重处理动态字符串**：对于包含变量占位符（例如 `t('欢迎，${name}')`），建议手动抽取或先改为模板式写法，避免插件自动分割出错。
* **在较大项目中分阶段执行**：如果项目中未定义词条很多，建议分模块 / 分文件逐步修复，而不是一次性操作全部，便于 review。
* **与版本控制配合**：在执行替换操作前，建议提交一次版本控制（git commit），以便出问题时能回退。
* **命名风格统一**：建议团队统一 key 命名规则（前缀、命名风格、模块划分等），以保持翻译文件可维护性。
* **校验重复条目**：在预览阶段注意检查是否存在多个不同文本被映射为同一个 Key 的情况，以免覆盖或语义混乱。 -->




